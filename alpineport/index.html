<!DOCTYPE html>
<html lang="en">

<head>
    <title>ACE in Action</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="/ace/ace.js"></script>
    <script src="/ace/ext-language_tools.js"></script>
    <script src="/ace/ext-statusbar.js"></script>
    <script type="module" src="/src/index.js"></script>

</head>

<body x-data="AceApp()" class="h-full flex flex-col">
    <div class="grow w-full relative h-screen">
        <div id="editor-wrapper" :class="$store.bottomBar.move && 'h-[70vh]'" class="h-[96vh]">
            <div id="editor" class="h-full w-full" x-init="readFromUrl()"></div>
        </div>
        <div id="floating-buttons" :class="$store.ace.decOpacity && 'opacity-20'"
            class="top-3 flex flex-col absolute rounded-xl right-3 z-10">
            <button @click="openSettingsMenu()" class="side-button group">
                <svg class="group-hover:animate-spin">
                    <use href="/src/assets/sprite.svg#icon-settings"></use>
                </svg>
            </button>
            <button @click="$store.bottomBar.move = !$store.bottomBar.move" class="side-button group">
                <svg class="group-hover:animate-pulse">
                    <use href="/src/assets/sprite.svg#icon-terminal"></use>
                </svg>
            </button>
            <template x-if="$store.marked.previewButton">
                <button x-data="markedPreview()" @click="fetchPreviewHtml()" class="side-button group">
                    <svg class="group-hover:animate-pulse">
                        <use href="/src/assets/sprite.svg#icon-preview"></use>
                    </svg>
                </button>
            </template>
            <div class=" flex flex-col relative" x-data="{ open: false }" x-on:keydown.esc.prevent.stop="open = false"
                x-on:click="open = !open">
                <button @click="{ open: true }" class="side-button group">
                    <svg class="h-6 w-6 text-current group-hover:animate-pulse">
                        <use href="/src/assets/sprite.svg#icon-load"></use>
                    </svg>
                </button>
                <div id="dropdown-container" class="flex flex-col" x-cloak x-show="open"
                    x-transition:enter="transition ease-out duration-100"
                    x-transition:enter-start="opacity-0 -translate-y-3"
                    x-transition:enter-end="opacity-100 translate-y-0"
                    x-transition:leave="transition ease-in duration-75"
                    x-transition:leave-start="opacity-100 translate-y-0"
                    x-transition:leave-end="opacity-0 translate-y-10" x-on:click.outside="open = false" role="menu"
                    aria-labelledby="pm-dropdown">
                    <button class="side-button mt-2 group" @click="$store.ace.openfile = true">
                        <svg class="h-6 w-6 text-current group-hover:animate-pulse">
                            <use href="/src/assets/sprite.svg#icon-computer"></use>
                        </svg>
                    </button>
                    <button class="side-button mt-2 group"
                    @click="alert('I will implement this later along with the backend')">
                        <svg class="h-6 w-6 text-current group-hover:animate-pulse">
                            <use href="/src/assets/sprite.svg#icon-server"></use>
                        </svg>
                    </button>
                    <button class="side-button group" @click="$store.ace.save = !$store.ace.save">
                        <svg class="group-hover:animate-pulse">
                            <use href="/src/assets/sprite.svg#icon-save"></use>
                        </svg>
                    </button>
                </div>
            </div>
        </div>
        <div x-show="$store.ace.save" id="save-dialog" class="modal">
            <div id="modal-content"
                class="flex  flex-col p-4 gap-4 overflow-hidden rounded-sm border border-neutral-300 bg-white text-neutral-600 dark:border-neutral-700 dark:bg-neutral-900 dark:text-neutral-300"
                @click.outside="$store.ace.save = false">
                <button @click="() => {$store.ace.save = false}" class="hover:cursor-pointer w-min self-end"
                    aria-label="close modal">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" aria-hidden="true" stroke="currentColor"
                        fill="none" stroke-width="1.4" class="w-5 h-5">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" />
                    </svg>
                </button>
                <h2 class="text-xl font-bold mb-4">Save File</h2>
                <button @click="$store.ace.isUrl = true; save()" class="bg-blue-500 text-white px-4 py-2 rounded w-auto">Save
                    as url</button>
                <h4 class="text-sm italic text-neutral-700 max-w-20vw w-auto">"The Save as Url" has <span class="text-neutral-500"> Size Limitation ( tested - 20,000 Lines of code ) </span> and hence for longer
                    codes please use the file download below. Also <span class="text-neutral-500">longer code means longer and ugly url</span> </h4>
                <span class="self-center">or</span>
                <div x-data="{ filename: 'Enter here...', btnContent: 'Download File' }" x-effect="$store.ace.isFsapi ? btnContent = 'Save File Back': btnContent = 'Download File'">
                    <div x-show="!$store.ace.isFsapi" class="mb-4">
                        <label for="filename" class="block mb-2">Filename:</label>
                        <input x-show="!$store.ace.isFsapi" type="text" id="filename" x-model="filename"
                            class="w-full p-2 border border-gray-300 rounded ">
                        <h4 class="text-sm italic text-neutral-700"> Please do not forget to enter
                         <span class="text-neutral-500">the  file extension (eg .txt, .py...) of your file</span></h4>
                    </div>

                    <div class="h-min w-full flex justify-center">
                        <button @click="save(filename)"
                            class="bg-green-500 text-white self-end px-4 py-2 rounded" x-text="btnContent"></button>
                    </div>
                </div>
            </div>
        </div>
        <div x-show="$store.ace.openfile" id="open-dialog" class="modal">
            <div id="modal-content"
                class="flex  flex-col p-4 gap-4 overflow-hidden rounded-sm border border-neutral-300 bg-white text-neutral-600 dark:border-neutral-700 dark:bg-neutral-900 dark:text-neutral-300"
                @click.outside="$store.ace.openfile = false"
                @click.stop>
                <button @click="() => {$store.ace.openfile = false}" class="hover:cursor-pointer w-min self-end"
                    aria-label="close modal">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" aria-hidden="true" stroke="currentColor"
                        fill="none" stroke-width="1.4" class="w-5 h-5">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" />
                    </svg>
                </button>
                <h2 class="text-xl font-bold mb-4 text-center">Open File</h2>
                <div class="grid grid-cols-2 gap-2">
                    <button @click="$store.ace.isFsapi = false; openFile()"
                        class="bg-blue-500 text-white px-4 py-2 rounded">Open using File Input</button>
                    <button @click="$store.ace.isFsapi = true; openFile()"
                        class="bg-green-500 text-white px-4 py-2 rounded">Open using File System Access API</button>
                    <h4 class="col-span-2 text-sm italic text-neutral-700">The <span class="text-neutral-500">File
                            System Access API </span> may not be supported in all browsers. Also cannot open sensitive
                            files for security reasons. <span class="text-neutral-500">But it allows direct file access.
                            The other button has no direct save feature.
                            User must download the file and save manually</span></h4>
                </div>
            </div>
        </div>
        <div id="bottom-bar" :class="$store.bottomBar.move && 'h-[30vh]'"
            class="absolute bottom-0 left-0 right-0 flex flex-col z-10">
            <div id="bottom-row" class="flex flex-row h-8">
                <div id="status-bar" x-data="{ message: 'No file loaded' }" class="bg-[#303030]  px-2">
                    <span class="text-white" x-text="message"></span>
                </div>
                <div id="status-bar-left" class=" bg-[#303030]  grow flex items-center justify-end select-none px-2">
                    <div x-init="initStatusBar()" class="text-white bg-[#444] rounded-lg min-w-4 px-2 mx-2"></div>
                    <div class="h-6 border-l border-gray-500"></div>
                    <div id="language-status" x-data="statusBar" x-init="init()" class="flex flex-row items-center">
                        <div id="language-icon" class="text-white mx-1 h-full  rounded-2xl "><img
                                class="object-contain rounded-2xl w-auto h-auto min-w-7 min-h-7" :src="currentIcon"></div>
                                <div class="h-6 border-l border-gray-500"></div>
                        <span class="text-white px-1" x-text="languageSelected"></span>
                    </div>
                </div>
            </div>
            <template x-if="$store.bottomBar.move">
                <div x-ref="terminal" x-data="terminal" x-init="init()" class="grow h-auto overflow-hidden">
                </div>
            </template>
        </div>
        <template x-if="menuCloseButton">
            <div x-ref="clsBtn" class="ace_optionsMenuEntry justify-center!" @click="closeSettingsMenu()">Close
                Menu
            </div>
        </template>
        <!-- template x-if="$store.marked.markedPreviewOpen">
            <div id="markdown-wrapper" class="resizable absolute top-0 overflow-auto right-4 bottom-8 w-2/3">
                <div>
                    <h1 class="text-2xl text-white text-center bg-github rounded-lg my-1"><b>Markdown Preview</b></h1>
                </div>
                <div id="markdown-body"
                    class="markdown-body  bg-neutral-900 text-white rounded-lg border-l-2 border-gray-300 p-4"
                    x-data="markedPreview">
                    <div x-html="renderedMarkdown"></div>
                </div>
            </div>
        < /template -->
    </div>
</body>

</html>